<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>German Law Assistant</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>Welcome to the German Law Assistant</h1>

    <!-- Chat Output Area -->
    <div id="chatContainer" class="chat-container">
      <!-- Questions and responses will appear here -->
    </div>

    <!-- Input Area for User's Question -->
    <div class="question-form">
      <textarea id="questionInput" placeholder="Type your question here and press Enter..." rows="2"></textarea>
      <button id="submitButton">Submit</button>
    </div>
    
    <!-- Area to display the answer -->
    <div id="answerBox" class="answer-box"></div>
  </div>

  <script src="script.js"></script>
  <script>
    // Function to submit the question
    async function submitQuestion() {
      const questionInput = document.getElementById('questionInput');
      const question = questionInput.value.trim();

      if (!question) return; // Prevent submitting empty questions

      // Clear the input area
      questionInput.value = '';

      // Display the user's question in the chat container
      const chatContainer = document.getElementById('chatContainer');
      const userQuestionElement = document.createElement('div');
      userQuestionElement.textContent = `You: ${question}`;
      chatContainer.appendChild(userQuestionElement);

      try {
        const answer = await askQuestion(question); // Call the API
        const botAnswerElement = document.createElement('div');
        botAnswerElement.textContent = `Bot: ${answer}`;
        chatContainer.appendChild(botAnswerElement); // Display the answer
      } catch (error) {
        console.error('Error fetching the answer:', error);
        const errorElement = document.createElement('div');
        errorElement.textContent = 'Error getting the response. Please try again.';
        chatContainer.appendChild(errorElement);
      }
    }

    // Function to call the serverless function
    async function askQuestion(question) {
      const response = await fetch('/api/queryClaude', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ question }),
      });

      if (!response.ok) {
        throw new Error('Network response was not ok');
      }

      const data = await response.json();
      return data; // This should return the response from Claude
    }

    // Add event listener to the submit button
    document.getElementById('submitButton').addEventListener('click', submitQuestion);
    
    // Optional: Add event listener for pressing Enter in the textarea
    document.getElementById('questionInput').addEventListener('keydown', function(event) {
      if (event.key === 'Enter') {
        event.preventDefault(); // Prevent new line in textarea
        submitQuestion();
      }
    });
  </script>
</body>
</html>
